<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Autistic Traits Quiz (Educational)</title>
  <style>
    :root{
      --bg:#0b1220; --card:#121a2b; --ink:#e6e9f2; --muted:#9aa3b2;
      --primary:#7c9cff; --accent:#22c55e; --warn:#fbbf24; --danger:#ef4444;
      --ring:rgba(124,156,255,.35)
    }
    *{box-sizing:border-box}
    body{
      margin:0; padding:32px 16px; color:var(--ink);
      background:linear-gradient(180deg,#0b1220,#0f172a);
      font:500 16px/1.6 ui-sans-serif,system-ui,Segoe UI,Roboto,Ubuntu,Apple Color Emoji,Segoe UI Emoji;
      -webkit-font-smoothing:antialiased;
    }
    .wrap{max-width:980px;margin:auto}
    .card{
      background:var(--card); border:1px solid rgba(255,255,255,.07);
      border-radius:16px; padding:22px 20px; box-shadow:0 12px 32px rgba(0,0,0,.28)
    }
    h1{margin:0 0 6px; font-size:28px}
    .sub{margin:0 0 14px; color:var(--muted)}
    .badge{display:inline-flex;gap:8px;align-items:center;background:var(--accent);color:#071016;
      font-weight:800;font-size:12px;letter-spacing:.3px;border-radius:999px;padding:6px 10px;margin:8px 0 16px}
    .disclaimer{
      background:rgba(251,191,36,.08);border:1px dashed rgba(251,191,36,.45);
      color:#fde68a; padding:10px 12px; border-radius:12px; font-size:14px; margin:8px 0 18px
    }
    .progress{display:flex;align-items:center;gap:12px;margin:12px 0 18px}
    .bar{flex:1;height:10px;background:#0b1020;border-radius:999px;overflow:hidden;border:1px solid rgba(255,255,255,.06)}
    .bar>span{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--primary),#b79cff);transition:width .25s ease}
    .group{margin-top:14px;padding-top:8px;border-top:1px solid rgba(255,255,255,.07)}
    .group h2{font-size:18px;margin:6px 0 8px}
    .q{padding-top:12px}
    .q h3{margin:0 0 10px;font-size:16px}
    .opts{display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:10px}
    .opt{
      display:flex;align-items:center;gap:8px;background:#0c1426;border:1px solid rgba(255,255,255,.08);
      border-radius:12px;padding:10px;cursor:pointer;transition:transform .05s ease,border-color .15s ease
    }
    .opt:hover{transform:translateY(-1px);border-color:var(--primary)}
    input[type="radio"]{accent-color:var(--primary);transform:scale(1.12)}
    .scale-hint{display:flex;justify-content:space-between;color:var(--muted);font-size:12px;margin-top:8px}
    .btns{display:flex;flex-wrap:wrap;gap:10px;margin-top:18px}
    button{
      background:var(--primary);color:white;border:0;padding:12px 16px;border-radius:12px;
      font-weight:800;letter-spacing:.3px;cursor:pointer;transition:filter .15s ease, transform .06s ease;
      box-shadow:0 6px 18px var(--ring)
    }
    button:hover{filter:brightness(1.05)} button:active{transform:translateY(1px)}
    .ghost{background:transparent;border:1px solid rgba(255,255,255,.12);color:var(--ink);box-shadow:none}
    .danger{background:var(--danger)}
    .error{color:#fecaca;margin-top:8px;display:none}
    .hidden{display:none}
    .result{
      margin-top:18px;padding:16px;border-radius:14px;background:#0b1428;border:1px solid rgba(255,255,255,.08)
    }
    .grid-2{display:grid;grid-template-columns:1fr;gap:12px}
    @media (min-width:760px){.grid-2{grid-template-columns:1fr 1fr}}
    .tag{display:inline-block;background:#0d1a33;border:1px solid rgba(255,255,255,.06);padding:6px 10px;border-radius:999px;font-size:12px;color:var(--muted)}
    .score{font-size:28px;font-weight:900}
    .chip{display:inline-flex;gap:6px;align-items:center;border-radius:999px;padding:4px 8px;font-size:12px;border:1px solid rgba(255,255,255,.1)}
    footer{color:var(--muted);font-size:12px;margin-top:14px}
    a.link{color:#bfdbfe;text-decoration:underline dotted}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Autistic Traits Quiz</h1>
      <div class="disclaimer">
        ⚠️ This is <b>not</b> a diagnosis or medical advice. It’s a learning tool about traits often discussed in autism research.
        If your results raise questions or concerns, consider a licensed clinician for a proper assessment. For general info:
        <a class="link" href="https://www.who.int/health-topics/autism-spectrum-disorders" target="_blank" rel="noopener">WHO: Autism</a>.
      </div>

      <div class="progress">
        <div id="progressText">Answered 0 / 24</div>
        <div class="bar" aria-hidden="true"><span id="progressBar"></span></div>
      </div>

      <form id="quiz" novalidate></form>

      <div class="btns">
        <button id="submitBtn" type="button">Calculate Score</button>
        <button id="shareBtn" type="button" class="ghost">Copy Share Link</button>
        <button id="resetBtn" type="button" class="ghost">Reset</button>
        <button id="printBtn" type="button" class="ghost">Print</button>
      </div>
      <div id="error" class="error">Please answer every statement before continuing.</div>

      <div id="result" class="result hidden" aria-live="polite"></div>

      
    </div>
  </div>

  <script>
    // ————————— Config —————————
    const SCALE_LABELS = ["Strongly Disagree","Disagree","Neutral","Agree","Strongly Agree"];

    const DOMAINS = {
      social: { label: "Social & Communication", color: "#60a5fa" },
      sensory: { label: "Sensory & Routine", color: "#f59e0b" },
      focus: { label: "Focus & Interests", color: "#34d399" }
    };

    // 24 items, all oriented so higher = more endorsement of the trait.
    const QUESTIONS = [
      // Social & Communication (0..7)
      {t:"I find it hard to make small talk.", d:"social"},
      {t:"I sometimes miss hints that someone wants to end a conversation.", d:"social"},
      {t:"I prefer clear, direct language over implied meanings.", d:"social"},
      {t:"I find eye contact uncomfortable or tiring.", d:"social"},
      {t:"Group conversations are exhausting for me.", d:"social"},
      {t:"I find it hard to understand sarcasm or jokes without context.", d:"social"},
      {t:"I need time to process what people say before responding.", d:"social"},
      {t:"I prefer texting or writing to phone calls or spontaneous chats.", d:"social"},
      // Sensory & Routine (8..15)
      {t:"Sudden noises, bright lights, or strong smells overwhelm me.", d:"sensory"},
      {t:"I prefer wearing the same comfortable clothes or fabrics.", d:"sensory"},
      {t:"I feel anxious when my routine is disrupted.", d:"sensory"},
      {t:"I notice tiny sensory details (sounds, textures) that others miss.", d:"sensory"},
      {t:"I avoid crowded or noisy places when I can.", d:"sensory"},
      {t:"I seek out calming repetitive movements (e.g., fidgeting).", d:"sensory"},
      {t:"I have strong preferences about how food should taste or feel.", d:"sensory"},
      {t:"I plan my day to minimize surprises.", d:"sensory"},
      // Focus & Interests (16..23)
      {t:"I can focus on a topic for many hours without getting bored.", d:"focus"},
      {t:"I develop deep, specialized interests and like learning everything about them.", d:"focus"},
      {t:"I prefer doing one task at a time rather than switching often.", d:"focus"},
      {t:"I get frustrated when rules or systems are inconsistent.", d:"focus"},
      {t:"I like organizing objects or data into categories and patterns.", d:"focus"},
      {t:"I prefer clear schedules and predictability.", d:"focus"},
      {t:"I find it hard to stop a task before it feels complete.", d:"focus"},
      {t:"I remember facts and details about my interests for a long time.", d:"focus"}
    ];

    // ————————— DOM refs —————————
    const form = document.getElementById("quiz");
    const resultBox = document.getElementById("result");
    const errorBox = document.getElementById("error");
    const progressText = document.getElementById("progressText");
    const progressBar = document.getElementById("progressBar");
    const shareBtn = document.getElementById("shareBtn");

    // ————————— Render —————————
    function makeId(i, v){ return `q${i}_v${v}`; }

    function render(){
      form.innerHTML = "";
      // group by domain for nice sections
      const groups = Object.keys(DOMAINS);
      groups.forEach(g => {
        const gWrap = document.createElement("section");
        gWrap.className = "group";
        gWrap.innerHTML = `<h2>${DOMAINS[g].label}</h2>`;
        QUESTIONS.forEach((q,i)=>{
          if(q.d !== g) return;
          const field = document.createElement("fieldset");
          field.className = "q";
          field.innerHTML = `
            <legend><h3>${i+1}. ${q.t}</h3></legend>
            <div class="opts" role="radiogroup" aria-label="Item ${i+1}">
              ${[1,2,3,4,5].map(v => `
                <label class="opt" for="${makeId(i,v)}">
                  <input type="radio" id="${makeId(i,v)}" name="q${i}" value="${v}" />
                  <span>${SCALE_LABELS[v-1]}</span>
                </label>
              `).join("")}
            </div>
            <div class="scale-hint"><span>${SCALE_LABELS[0]}</span><span>${SCALE_LABELS[4]}</span></div>
          `;
          gWrap.appendChild(field);
        });
        form.appendChild(gWrap);
      });
    }
    render();

    // ————————— Answers & Progress —————————
    function getAnswers(){
      const values = [];
      for(let i=0;i<QUESTIONS.length;i++){
        const sel = form.querySelector(`input[name="q${i}"]:checked`);
        values.push(sel ? Number(sel.value) : null);
      }
      return values;
    }

    function updateProgress(){
      const answers = getAnswers();
      const done = answers.filter(v => v !== null).length;
      progressText.textContent = `Answered ${done} / ${QUESTIONS.length}`;
      const pct = Math.round((done / QUESTIONS.length) * 100);
      progressBar.style.width = pct + "%";
    }
    form.addEventListener("change", updateProgress);
    updateProgress();

    function firstMissingIndex(){
      const answers = getAnswers();
      return answers.findIndex(v => v === null);
    }

    function scrollToQuestion(i){
      const target = form.querySelectorAll(".q")[i];
      if (target){
        target.scrollIntoView({behavior:"smooth", block:"center"});
        target.style.outline = "2px solid #ef4444";
        setTimeout(()=> target.style.outline = "none", 1200);
      }
    }

    // ————————— Scoring —————————
    function sumRange(vals, start, end){
      let s = 0;
      for(let i=start;i<=end;i++) s += vals[i];
      return s;
    }

    function band(total, min, max){
      const span = max - min;
      const rel = (total - min) / span; // 0..1
      if (rel <= 0.33) return {name:"Lower", tone:"Fewer listed traits endorsed.", color:"#22c55e"};
      if (rel <= 0.66) return {name:"Typical", tone:"About average endorsement.", color:"#60a5fa"};
      if (rel <= 0.85) return {name:"Elevated", tone:"More endorsement than average.", color:"#f59e0b"};
      return {name:"Very High", tone:"Strong endorsement of listed traits.", color:"#ef4444"};
    }

    function pct(total, min, max){
      return Math.round(((total - min) / (max - min)) * 100);
    }

    function showResult(scores){
      const { total, social, sensory, focus } = scores;
      const minT=24, maxT=120, minD=8, maxD=40;

      const bT = band(total, minT, maxT);
      const bS = band(social, minD, maxD);
      const bR = band(sensory, minD, maxD);
      const bF = band(focus, minD, maxD);

      resultBox.classList.remove("hidden");
      resultBox.innerHTML = `
        <div class="grid-2">
          <div>
            <div class="tag">Your total</div>
            <div class="score" style="color:${bT.color}">${total} / ${maxT}</div>
            <div class="tag" style="margin-top:8px">~${pct(total,minT,maxT)}% of maximum endorsement</div>
            <p style="margin:10px 0 0"><span class="chip" style="border-color:${bT.color};color:${bT.color}">Overall: <b style="margin-left:6px">${bT.name}</b></span></p>
          </div>
          <div>
            <div class="tag">Interpretation</div>
            <p style="margin:6px 0 8px"><b>${bT.name}</b> — ${bT.tone}</p>
            <ul style="margin:0 0 10px 18px">
              <li>Higher scores = stronger agreement with the listed traits.</li>
              <li>This is <b>educational</b>, not diagnostic. A qualified clinician can use validated tools and clinical history.</li>
            </ul>
          </div>
        </div>

        <div style="margin-top:14px">
          <div class="tag">Subscales</div>
          <div style="display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px;margin-top:10px">
            <div style="border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px">
              <div style="color:${DOMAINS.social.color};font-weight:800">${DOMAINS.social.label}</div>
              <div>${social} / ${maxD} · ${pct(social,minD,maxD)}%</div>
              <div style="color:${bS.color};font-size:13px">${bS.name} — ${bS.tone}</div>
            </div>
            <div style="border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px">
              <div style="color:${DOMAINS.sensory.color};font-weight:800">${DOMAINS.sensory.label}</div>
              <div>${sensory} / ${maxD} · ${pct(sensory,minD,maxD)}%</div>
              <div style="color:${bR.color};font-size:13px">${bR.name} — ${bR.tone}</div>
            </div>
            <div style="border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px">
              <div style="color:${DOMAINS.focus.color};font-weight:800">${DOMAINS.focus.label}</div>
              <div>${focus} / ${maxD} · ${pct(focus,minD,maxD)}%</div>
              <div style="color:${bF.color};font-size:13px">${bF.name} — ${bF.tone}</div>
            </div>
          </div>
        </div>
      `;
      resultBox.scrollIntoView({behavior:"smooth", block:"start"});
    }

    // ————————— Buttons —————————
    document.getElementById("submitBtn").addEventListener("click", () => {
      errorBox.style.display = "none";
      const miss = firstMissingIndex();
      if (miss !== -1){
        errorBox.style.display = "block";
        scrollToQuestion(miss);
        return;
      }
      const answers = getAnswers();
      const total   = answers.reduce((a,b)=>a+b,0);
      const social  = sumRange(answers, 0, 7);
      const sensory = sumRange(answers, 8, 15);
      const focus   = sumRange(answers, 16, 23);

      // store last results for sharing
      window.__ATQ_LAST = { total, social, sensory, focus };
      showResult(window.__ATQ_LAST);
    });

    document.getElementById("resetBtn").addEventListener("click", () => {
      form.querySelectorAll('input[type="radio"]').forEach(i=> i.checked = false);
      resultBox.classList.add("hidden");
      resultBox.innerHTML = "";
      errorBox.style.display = "none";
      updateProgress();
      window.__ATQ_LAST = null;
      history.replaceState(null, "", location.pathname); // clear hash
      window.scrollTo({top:0, behavior:"smooth"});
    });

    document.getElementById("printBtn").addEventListener("click", () => window.print());

    // Shareable link encodes only the summary (not your individual answers)
    shareBtn.addEventListener("click", async () => {
      if (!window.__ATQ_LAST){
        errorBox.textContent = "Calculate your score first, then share.";
        errorBox.style.display = "block";
        return;
      }
      const { total, social, sensory, focus } = window.__ATQ_LAST;
      const hash = `#atq:v=1;t=${total};soc=${social};sen=${sensory};foc=${focus}`;
      const url = location.origin + location.pathname + hash;
      try{
        await navigator.clipboard.writeText(url);
        shareBtn.textContent = "Link copied ✅";
        setTimeout(()=> shareBtn.textContent = "Copy Share Link", 1500);
      }catch{
        // fallback
        prompt("Copy your results link:", url);
      }
    });

    // If page opened with a results hash, show a summary header.
    (function readHash(){
      if (!location.hash.startsWith("#atq:")) return;
      const parts = Object.fromEntries(
        location.hash.replace("#atq:","").split(";").map(kv => kv.split("="))
      );
      const total = Number(parts.t||0), social = Number(parts.soc||0), sensory = Number(parts.sen||0), focus = Number(parts.foc||0);
      if (total && social && sensory && focus){
        window.__ATQ_LAST = { total, social, sensory, focus };
        showResult(window.__ATQ_LAST);
      }
    })();
  </script>
</body>
</html>
